<Window x:Class="MixItUp.Installer.MainWindow"
 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
 xmlns:local="clr-namespace:MixItUp.Installer"
 xmlns:MaterialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
 mc:Ignorable="d" Style="{StaticResource MaterialDesignWindow}" Icon="./Logo.ico" Title="Mix It Up - Installer" Height="520" Width="900" MinHeight="480" MinWidth="780">
  <Window.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Button.xaml"/>
        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Card.xaml"/>
        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.ListBox.xaml"/>
        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.ProgressBar.xaml"/>
        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.TextBlock.xaml"/>
        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Shadows.xaml"/>
        <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.ToggleButton.xaml"/>
      </ResourceDictionary.MergedDictionaries>
      <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
      <Style x:Key="HeaderTitleTextBlock"
 TargetType="TextBlock" BasedOn="{StaticResource MaterialDesignTitleLargeTextBlock}">
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="TextWrapping" Value="Wrap"/>
      </Style>
      <Style x:Key="HeaderSubtitleTextBlock"
 TargetType="TextBlock" BasedOn="{StaticResource MaterialDesignBodyMediumTextBlock}">
        <Setter Property="TextWrapping" Value="Wrap"/>
      </Style>
      <Style x:Key="StatusHeadlineTextBlock"
 TargetType="TextBlock" BasedOn="{StaticResource MaterialDesignHeadlineSmallTextBlock}">
        <Setter Property="TextWrapping" Value="Wrap"/>
      </Style>
      <Style x:Key="StatusBodyTextBlock"
 TargetType="TextBlock" BasedOn="{StaticResource MaterialDesignBodyMediumTextBlock}">
        <Setter Property="TextWrapping" Value="Wrap"/>
      </Style>
      <Style x:Key="ChecklistSectionTitleTextBlock"
 TargetType="TextBlock" BasedOn="{StaticResource MaterialDesignTitleMediumTextBlock}">
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Margin" Value="0,0,0,12"/>
      </Style>
      <Style x:Key="ChecklistLabelTextBlock"
 TargetType="TextBlock" BasedOn="{StaticResource MaterialDesignBodyLargeTextBlock}">
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="TextWrapping" Value="Wrap"/>
      </Style>
      <Style x:Key="ChecklistIconStyle"
 TargetType="MaterialDesign:PackIcon">
        <Setter Property="Width" Value="20"/>
        <Setter Property="Height" Value="20"/>
        <Setter Property="HorizontalAlignment" Value="Center"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
      </Style>
      <Style x:Key="ChecklistStepContainerStyle"
 TargetType="Border">
        <Setter Property="Padding" Value="16"/>
        <Setter Property="Margin" Value="0,8"/>
        <Setter Property="CornerRadius" Value="12"/>
        <Setter Property="Background" Value="{DynamicResource MaterialDesign.Brush.SurfaceVariant}"/>
      </Style>
      <Style x:Key="ChecklistStepGridStyle"
 TargetType="Grid">
        <Setter Property="Margin" Value="0,0,0,4"/>
      </Style>
      <Style x:Key="ChecklistProgressStyle"
 TargetType="ProgressBar">
        <Setter Property="Height" Value="4"/>
        <Setter Property="IsIndeterminate" Value="True"/>
        <Setter Property="Margin" Value="0,8,0,0"/>
      </Style>
      <Style TargetType="ListBoxItem" BasedOn="{StaticResource MaterialDesignListBoxItem}">
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Margin" Value="0,2"/>
      </Style>
    </ResourceDictionary>
  </Window.Resources>
  <MaterialDesign:DialogHost>
    <Grid Margin="24">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>
      <!-- Header -->
      <Grid Grid.Row="0" Margin="0,0,0,24">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Image Grid.Column="0" Source="./Logo.png" Width="56" Height="56" Stretch="Uniform" Margin="0,0,24,0"/>
        <StackPanel Grid.Column="1" VerticalAlignment="Center">
          <TextBlock Text="MixItUp Installer" Style="{StaticResource HeaderTitleTextBlock}"/>
          <TextBlock Text="Setting you up for fast, reliable updates." Style="{StaticResource HeaderSubtitleTextBlock}" Margin="0,8,0,0"/>
        </StackPanel>
      </Grid>
      <!-- Main Content -->
      <Grid Grid.Row="1">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="2*"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <!-- Status Panel -->
        <MaterialDesign:Card Grid.Column="0" Margin="0,0,24,0" Padding="24" Background="{DynamicResource MaterialDesign.Brush.Surface}" UniformCornerRadius="12" MaterialDesign:ElevationAssist.Elevation="Dp4">
          <StackPanel>
            <TextBlock Text="{Binding DisplayText1}" Style="{StaticResource StatusHeadlineTextBlock}"/>
            <StackPanel Orientation="Horizontal" Margin="0,12,0,0" Visibility="{Binding ShowHyperlinkAddress, Converter={StaticResource BooleanToVisibilityConverter}}">
              <TextBlock Text="Installer log:" Style="{StaticResource StatusBodyTextBlock}" VerticalAlignment="Center"/>
              <TextBlock Margin="8,0,0,0" VerticalAlignment="Center" Style="{StaticResource StatusBodyTextBlock}">
                <Hyperlink NavigateUri="{Binding HyperlinkAddress}" RequestNavigate="Hyperlink_RequestNavigate">Open file</Hyperlink>
              </TextBlock>
            </StackPanel>
            <TextBlock Text="{Binding DisplayText2}" Style="{StaticResource StatusBodyTextBlock}" Visibility="{Binding ErrorOccurred, Converter={StaticResource BooleanToVisibilityConverter}}" Margin="0,12,0,0"/>
            <Border Background="{DynamicResource MaterialDesign.Brush.SurfaceVariant}" Padding="16" CornerRadius="10" Margin="0,20,0,20" MaterialDesign:ElevationAssist.Elevation="Dp1">
              <ListBox x:Name="ActivityLogList"
 ItemsSource="{Binding ActivityLog}" BorderThickness="0" Background="Transparent" ScrollViewer.VerticalScrollBarVisibility="Auto" SelectionMode="Single">
                <ListBox.ItemsPanel>
                  <ItemsPanelTemplate>
                    <StackPanel/>
                  </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding}" Style="{StaticResource StatusBodyTextBlock}" Margin="0,2"/>
                  </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
            </Border>
            <ProgressBar Height="6" Minimum="0" Maximum="100" Value="{Binding DownloadPercent}" Margin="0,0,0,12">
              <ProgressBar.Style>
                <Style TargetType="ProgressBar">
                  <Setter Property="Visibility" Value="Collapsed"/>
                  <Style.Triggers>
                    <DataTrigger Binding="{Binding StepLauncherFetchInProgress}" Value="True">
                      <Setter Property="Visibility" Value="Visible"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding StepAppFetchInProgress}" Value="True">
                      <Setter Property="Visibility" Value="Visible"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding StepAppExtractInProgress}" Value="True">
                      <Setter Property="Visibility" Value="Visible"/>
                    </DataTrigger>
                  </Style.Triggers>
                </Style>
              </ProgressBar.Style>
            </ProgressBar>
            <ProgressBar Height="4" Margin="0,0,0,4" IsIndeterminate="{Binding IsOperationIndeterminate}" Visibility="{Binding IsOperationBeingPerformed, Converter={StaticResource BooleanToVisibilityConverter}}"/>
          </StackPanel>
        </MaterialDesign:Card>
        <!-- Checklist Panel -->
        <MaterialDesign:Card Grid.Column="1" Padding="24" Background="{DynamicResource MaterialDesign.Brush.Surface}" UniformCornerRadius="12" MaterialDesign:ElevationAssist.Elevation="Dp3">
          <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel>
              <TextBlock Text="Installation checklist" Style="{StaticResource ChecklistSectionTitleTextBlock}"/>
              <!-- Preflight -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepPreflightPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepPreflightDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Preflight checks" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepPreflightInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Discover -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepDiscoverPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepDiscoverDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Discover existing installs" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepDiscoverInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Close Processes -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepCloseProcessesPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepCloseProcessesDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Close running processes" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepCloseProcessesInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Migrate -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepMigratePending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepMigrateDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Migrate legacy data" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepMigrateInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Launcher Fetch -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepLauncherFetchPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepLauncherFetchDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Download launcher" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepLauncherFetchInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Launcher Install -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepLauncherInstallPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepLauncherInstallDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Install launcher" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepLauncherInstallInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- App Fetch -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepAppFetchPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepAppFetchDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Download app package" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepAppFetchInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- App Extract -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepAppExtractPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepAppExtractDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Extract app files" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepAppExtractInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Data Copy -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepDataCopyPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepDataCopyDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Copy user data" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepDataCopyInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Config Write -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepConfigWritePending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepConfigWriteDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Write configuration" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepConfigWriteInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Register -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepRegisterPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepRegisterDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Register with Windows" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepRegisterInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Shortcuts -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepShortcutsPending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepShortcutsDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Create shortcuts" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepShortcutsInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
              <!-- Complete -->
              <Border Style="{StaticResource ChecklistStepContainerStyle}">
                <Grid Style="{StaticResource ChecklistStepGridStyle}">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <Grid Width="24" Height="24" Margin="0,0,12,0">
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxBlankCircleOutline" Visibility="{Binding StepCompletePending, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <MaterialDesign:PackIcon Style="{StaticResource ChecklistIconStyle}" Kind="CheckboxMarkedCircle" Visibility="{Binding StepCompleteDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </Grid>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="Complete" Style="{StaticResource ChecklistLabelTextBlock}"/>
                    <ProgressBar Style="{StaticResource ChecklistProgressStyle}" Visibility="{Binding StepCompleteInProgress, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                  </StackPanel>
                </Grid>
              </Border>
            </StackPanel>
          </ScrollViewer>
        </MaterialDesign:Card>
      </Grid>
      <!-- Footer -->
      <Grid Grid.Row="2" Margin="0,24,0,0">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <StackPanel Grid.Column="0" VerticalAlignment="Center">
          <TextBlock Text="{Binding AppRoot}" Style="{StaticResource StatusBodyTextBlock}"/>
        </StackPanel>
        <Button Grid.Column="1" Content="Launch Mix It Up" Command="{Binding LaunchCommand}" Margin="24,0,0,0" Padding="24,10" Height="44" Visibility="{Binding StepCompleteDone, Converter={StaticResource BooleanToVisibilityConverter}}" MaterialDesign:ButtonAssist.CornerRadius="20">
          <Button.Style>
            <Style TargetType="Button" BasedOn="{StaticResource MaterialDesignRaisedButton}">
              <Setter Property="IsEnabled" Value="True"/>
              <Style.Triggers>
                <DataTrigger Binding="{Binding HasError}" Value="True">
                  <Setter Property="IsEnabled" Value="False"/>
                </DataTrigger>
              </Style.Triggers>
            </Style>
          </Button.Style>
        </Button>
      </Grid>
    </Grid>
  </MaterialDesign:DialogHost>
</Window>